SELECT 
	ANO,
	MES,
	VAL_TOTAL,
	SUM(VAL_TOTAL) OVER (PARTITION BY ANO ORDER BY MES) AS ACC
FROM 
(
	SELECT
		DATEPART(YY,DATA_VENDA) AS ANO,
		DATEPART(MM,DATA_VENDA) AS MES,
		SUM(VAL_TOTAL) AS VAL_TOTAL
	FROM
		fVendas
	GROUP BY
		DATEPART(YY,DATA_VENDA),
		DATEPART(MM,DATA_VENDA) 
) AS TB 
ORDER BY
	1;
